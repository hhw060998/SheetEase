# SheetEase

轻量级、零依赖、可扩展的 Excel → JSON + C# 导出工具，专为游戏等需要高效配置管理的场景设计。

> **对比 luban**：本工具更轻量、无平台/框架依赖、易于二次开发，适合小中型项目和 Unity 工程。支持自定义类型、引用校验、GUI 批量导出，开箱即用。

---

## 功能亮点

- **一键导出**：批处理或 GUI 一键批量导出 JSON 与 C# 代码。
- **严格校验**：字段命名、类型、主键唯一、引用关系等全流程检查。
- **高效集成**：C# 端自动生成访问类，O(1) 查询，支持多种查询方式。
- **自定义类型**：支持“通用回退”与“专用解析器”两种模式，灵活适配业务。
- **易用 GUI**：可视化路径选择、配置保存、实时日志，适合策划/程序协作。
- **零依赖**：仅需 Python 3.x，无需第三方库，易于集成到现有项目。

---

## 目录结构

```
ExcelExportTool/        # Python 源码
ExcelFolder/            # Excel 示例与批处理
ProjectFolder/          # C# 工程与导出示例
```

---

## 快速上手

1. **环境准备**
   - 安装 Python 3.x（建议 3.10+）。
   - 配置 `ExcelFolder/!【导表】.bat`：指定 Excel 目录、工具目录、输出目录。

2. **Excel 规范**
   - 文件名建议大写，Sheet 名需符合 C# 类命名规范。
   - 表头：第1行字段名，第2行类型（基础/自定义），第3行注释（可选）。

3. **导出方式**
   - 命令行：双击 `ExcelFolder/!【导表】.bat`。
   - GUI：运行 `python tools/gui_export_launcher.py` 或双击 `ExcelFolder/启动导表_GUI.bat`。
   - 路径选择、配置保存、运行导表、日志查看均在 GUI 内完成。

4. **C# 集成**
   - 将导出的 JSON 与 C# 文件加入项目，启动时加载即可。

---

## 数据类型与自定义类型

- 基础类型：`int`、`float`、`string/str`、`bool`
- 容器类型：`list(...)`、`dict(...)`
- **自定义类型**：
  - **通用回退**（默认）：Excel 类型行填写全限定名，单元格用 `#` 分隔，导出为 `{ "__type": ..., "segments": [...] }`，C# 端自定义解析。
  - **专用解析器**（可选）：在 `data_processing.py` 注册解析器，导出结构更语义化，C# 端可直接映射。

---

## 引用校验

- 字段名可加 `[Sheet/Field]` 前缀，自动检查引用存在性与类型一致性。
- 支持 list(T) 元素级校验，dict 类型会警告并跳过。
- 所有引用校验在导出后统一进行，错误/警告不会中断导表。

---

## 常见问题（FAQ）

- **Q: 新增自定义类型需要改 Python 吗？**
  - 不需要，通用回退已支持任意类型，仅需专用结构时注册解析器。
- **Q: C# 如何处理自定义类型？**
  - 用通用结构（`__type`+`segments`）或自定义类，业务层解释。
- **Q: 支持数组/字典嵌套自定义类型吗？**
  - 支持，list/dict 可嵌套，复杂场景可扩展解析器。
- **Q: 与 luban 有何区别？**
  - luban 功能更全、支持多语言/格式，适合大型项目；本工具更轻量、易用、零依赖，适合快速集成和定制。

---

## 示例与参考

- Excel 示例：`ExcelFolder/SL示例.xlsx`、`ExcelFolder/SL组合key示例.xlsx`
- 自动生成 C#：`ProjectFolder/ConfigData/AutoGeneratedScript/`
- JSON 示例：`ProjectFolder/Json/`

---

## License

本仓库代码和示例以根目录 `LICENSE` 为准。

---

# English Version

## SheetEase

A lightweight, dependency-free, and extensible Excel → JSON + C# exporter, designed for efficient config management in games and similar projects.

> **Compared to luban**: This tool is lighter, has no platform/framework dependencies, and is easy to extend. It is ideal for small/medium projects and Unity. Supports custom types, reference checks, and GUI batch export out of the box.

---

## Highlights

- **One-click export**: Batch or GUI export of JSON and C# code.
- **Strict validation**: Checks for field naming, types, primary key uniqueness, and references.
- **Efficient integration**: Auto-generated C# accessors, O(1) queries, multiple query helpers.
- **Custom types**: Supports both generic fallback and dedicated parser modes.
- **User-friendly GUI**: Visual path selection, config saving, real-time logs.
- **Zero dependencies**: Only needs Python 3.x, no third-party libraries.

---

## Structure

```
ExcelExportTool/        # Python source
ExcelFolder/            # Excel samples and batch
ProjectFolder/          # C# project and export samples
```

---

## Quick Start

1. **Requirements**
   - Python 3.x (3.10+ recommended).
   - Edit `ExcelFolder/!【导表】.bat` to set Excel, tool, and output directories.

2. **Excel Convention**
   - File name: UPPERCASE recommended; sheet name: C# class naming.
   - Header: row 1 field names, row 2 types (basic/custom), row 3 comments (optional).

3. **Export**
   - CLI: Double-click `ExcelFolder/!【导表】.bat`.
   - GUI: Run `python tools/gui_export_launcher.py` or double-click `ExcelFolder/启动导表_GUI.bat`.
   - All path selection, config, export, and logs are in the GUI.

4. **C# Integration**
   - Add exported JSON and C# to your project, load at startup.

---

## Data Types & Custom Types

- Basic: `int`, `float`, `string/str`, `bool`
- Containers: `list(...)`, `dict(...)`
- **Custom types**:
  - **Generic fallback** (default): Type row is fully qualified, cell uses `#` to split, exports as `{ "__type": ..., "segments": [...] }`, parse in C# as needed.
  - **Dedicated parser** (optional): Register in `data_processing.py` for semantic JSON, map directly in C#.

---

## Reference Checks

- Field names can have `[Sheet/Field]` prefix for auto existence/type checks.
- Supports list(T) element checks; dict fields are warned and skipped.
- All checks run after export; errors/warnings do not stop export.

---

## FAQ

- **Q: Do I need to modify Python for new custom types?**
  - No, generic fallback supports any type; only register a parser for special structure.
- **Q: How to handle custom types in C#?**
  - Use the generic structure (`__type`+`segments`) or a custom class, interpret in business logic.
- **Q: Are arrays/dicts of custom types supported?**
  - Yes, list/dict can nest custom types; extend parser for complex cases.
- **Q: How is this different from luban?**
  - luban is more feature-rich and supports more formats/languages for large projects; this tool is lighter, easier, and dependency-free for quick integration and customization.

---

## Examples

- Excel: `ExcelFolder/SL示例.xlsx`, `ExcelFolder/SL组合key示例.xlsx`
- C#: `ProjectFolder/ConfigData/AutoGeneratedScript/`
- JSON: `ProjectFolder/Json/`

---

## License

See `LICENSE` at the repository root.